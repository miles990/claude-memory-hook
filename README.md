# Claude Code Memory Hook

è‡ªå‹•è¼‰å…¥å°ˆæ¡ˆè¨˜æ†¶çš„ Claude Code Hookï¼Œè®“ä½ åœ¨ `/clear` æˆ–å•Ÿå‹•æ™‚è‡ªå‹•æ¢å¾©å°ˆæ¡ˆä¸Šä¸‹æ–‡ã€‚

## åŠŸèƒ½

- **è‡ªå‹•è¼‰å…¥å°ˆæ¡ˆç‹€æ…‹** - Git åˆ†æ”¯ã€æœ€è¿‘ commitsã€æœªæäº¤è®Šæ›´
- **è¦æ ¼è¿½è¹¤** - é¡¯ç¤ºé€²è¡Œä¸­çš„ `tasks.md` ç‹€æ…‹
- **Letta æ•´åˆ** - è‡ªå‹•åµæ¸¬é•·æœŸè¨˜æ†¶ server
- **é€šç”¨è¨­è¨ˆ** - ä¸€æ¬¡è¨­å®šï¼Œæ‰€æœ‰å°ˆæ¡ˆéƒ½èƒ½ç”¨

## æˆªåœ–

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ“š è‡ªå‹•è¼‰å…¥å°ˆæ¡ˆè¨˜æ†¶ - my-project
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” æœ¬åœ°å°ˆæ¡ˆç‹€æ…‹                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š Git ç‹€æ…‹:
   åˆ†æ”¯: main
   æœ€è¿‘ commit:
   abc1234 feat: æ–°å¢åŠŸèƒ½
   def5678 fix: ä¿®å¾© bug

ğŸ“‹ é€²è¡Œä¸­çš„è¦æ ¼:
   â€¢ feature-a: 2 é€²è¡Œä¸­, 5 å¾…è™•ç†, 10 å®Œæˆ

ğŸ“„ CLAUDE.md: âœ… å­˜åœ¨

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ§  é•·æœŸè¨˜æ†¶ (Letta)                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Letta Server é€£ç·šæ­£å¸¸
ğŸ“ å¯ç”¨çš„ Agents:
   â€¢ my-project-memory (abc12345...)

ğŸ’¡ æŸ¥è©¢æ­·å²è¨˜æ†¶: ã€ŒæŸ¥è©¢ Letta ä¸­é—œæ–¼ [ä¸»é¡Œ] çš„è¨˜éŒ„ã€
```

## å‰ç½®éœ€æ±‚

| å·¥å…· | ç”¨é€” | macOS | Linux |
|------|------|:-----:|:-----:|
| `bash` | åŸ·è¡Œè…³æœ¬ | âœ… é è£ | âœ… é è£ |
| `git` | é¡¯ç¤º Git ç‹€æ…‹ | âœ… é è£ | âœ… é è£ |
| `curl` | æª¢æŸ¥ Letta server | âœ… é è£ | âœ… é è£ |
| `python3` | è§£æ JSON | âœ… é è£ | âœ… é è£ |
| `find`, `grep` | æª”æ¡ˆæœå°‹ | âœ… é è£ | âœ… é è£ |

> **macOS å’Œå¤§å¤šæ•¸ Linux ç™¼è¡Œç‰ˆéƒ½å·²é è£æ‰€æœ‰ä¾è³´ï¼Œç„¡éœ€é¡å¤–å®‰è£ã€‚**

## å®‰è£

### å¿«é€Ÿå®‰è£ (æ¨è–¦)

```bash
curl -fsSL https://raw.githubusercontent.com/miles990/claude-memory-hook/main/install.sh | bash
```

### æ‰‹å‹•å®‰è£

1. **ä¸‹è¼‰è…³æœ¬**

```bash
mkdir -p ~/.claude/hooks
curl -o ~/.claude/hooks/load-memory.sh \
  https://raw.githubusercontent.com/miles990/claude-memory-hook/main/load-memory.sh
chmod +x ~/.claude/hooks/load-memory.sh
```

2. **è¨­å®š Hook**

ç·¨è¼¯ `~/.claude/settings.json`ï¼ŒåŠ å…¥ï¼š

```json
{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "$HOME/.claude/hooks/load-memory.sh"
          }
        ]
      }
    ]
  }
}
```

3. **é‡å•Ÿ Claude Code**

## è¨­å®š

### ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸ | é è¨­å€¼ | èªªæ˜ |
|------|--------|------|
| `LETTA_BASE_URL` | `http://localhost:8283` | Letta server URL |

### tasks.md ç”¢ç”Ÿæ–¹å¼

æ¨è–¦ä½¿ç”¨ [spec-workflow-mcp](https://github.com/kingkongshot/specs-workflow-mcp) è‡ªå‹•ç”¢ç”Ÿï¼š

```bash
# å®‰è£
claude mcp add spec-workflow -- npx spec-workflow-mcp

# åˆå§‹åŒ–æ–°åŠŸèƒ½è¦æ ¼
# Claude æœƒè‡ªå‹•ç”¢ç”Ÿ docs/specs/{feature}/ çµæ§‹
```

ç”¢ç”Ÿçš„çµæ§‹ï¼š
```
docs/specs/{feature}/
â”œâ”€â”€ requirements.md   # éœ€æ±‚è¦æ ¼
â”œâ”€â”€ design.md         # è¨­è¨ˆæ–‡ä»¶
â””â”€â”€ tasks.md          # ä»»å‹™æ¸…å–® â† æœ¬ hook è®€å–æ­¤æª”
```

tasks.md ä½¿ç”¨æ¨™æº– markdown checkboxï¼š
- `[x]` å®Œæˆçš„ä»»å‹™
- `[~]` é€²è¡Œä¸­çš„ä»»å‹™
- `[ ]` å¾…è™•ç†çš„ä»»å‹™

### æ”¯æ´çš„ç›®éŒ„çµæ§‹

è…³æœ¬æœƒè‡ªå‹•åµæ¸¬ä»¥ä¸‹è¦æ ¼ç›®éŒ„ï¼š
- `docs/specs/`
- `specs/`
- `.specs/`

### å°ˆæ¡ˆå°ˆå±¬è¦†è“‹

å¦‚æœç‰¹å®šå°ˆæ¡ˆéœ€è¦ä¸åŒè¡Œç‚ºï¼Œåœ¨å°ˆæ¡ˆç›®éŒ„å»ºç«‹ï¼š

```
your-project/
â””â”€â”€ .claude/
    â””â”€â”€ hooks/
        â””â”€â”€ load-memory.sh  # æœƒè¦†è“‹å…¨åŸŸè¨­å®š
```

## æ­é… Letta ä½¿ç”¨

é€™å€‹ hook è¨­è¨ˆç”¨ä¾†æ­é… [Letta](https://docs.letta.com/) ä½œç‚ºé•·æœŸè¨˜æ†¶å¾Œç«¯ã€‚

### å¿«é€Ÿè¨­ç½® Letta

```bash
# å®‰è£
pip install letta

# å•Ÿå‹• server
letta server

# åŠ å…¥ Claude Code MCP
npm install -g letta-mcp-server
claude mcp add letta -- letta-mcp --env LETTA_BASE_URL=http://localhost:8283/v1
```

### åˆ†å±¤è¨˜æ†¶æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: å³æ™‚è¨˜æ†¶ (Claude Code æœ¬åœ°)                           â”‚
â”‚  â”œâ”€â”€ CLAUDE.md      â†’ å°ˆæ¡ˆè¦å‰‡                                  â”‚
â”‚  â”œâ”€â”€ specs/         â†’ ç•¶å‰åŠŸèƒ½è¦æ ¼                              â”‚
â”‚  â””â”€â”€ TodoWrite      â†’ ç•¶å‰ä»»å‹™                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 2: é•·æœŸè¨˜æ†¶ (Letta)                                      â”‚
â”‚  â”œâ”€â”€ Core Memory    â†’ å°ˆæ¡ˆæ¶æ§‹ç†è§£                              â”‚
â”‚  â””â”€â”€ Archival       â†’ æ­·å²æ±ºç­–è¨˜éŒ„                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é–‹ç™¼

### è²¢ç»

æ­¡è¿ PRï¼è«‹ç¢ºä¿ï¼š
- è…³æœ¬åœ¨ bash å’Œ zsh éƒ½èƒ½é‹ä½œ
- ä¸ä¾è³´éæ¨™æº–å·¥å…·
- ä¿æŒè¼¸å‡ºç°¡æ½”

### æ¸¬è©¦

```bash
# æ¸¬è©¦è…³æœ¬
CLAUDE_PROJECT_DIR=/path/to/your/project ~/.claude/hooks/load-memory.sh
```

## License

MIT

## ç›¸é—œé€£çµ

- [Claude Code](https://claude.ai/code)
- [Claude Code Hooks æ–‡ä»¶](https://code.claude.com/docs/en/hooks)
- [Letta (MemGPT)](https://docs.letta.com/)
